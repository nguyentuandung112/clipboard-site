<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      color: #333;
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h1, h2, h3 {
      color: #0066cc;
    }
    textarea {
      width: 100%;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      padding: 8px 16px;
      margin: 5px 5px 10px 0;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    input[type="text"] {
      padding: 6px;
      margin: 4px;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    .field {
      margin: 8px 0;
      background: #eef2f7;
      padding: 10px;
      border-radius: 6px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .account-box, .controls, .stats-bar, #accountDisplay {
      margin-top: 20px;
      padding: 10px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 0 5px rgba(0,0,0,0.05);
    }
    .controls button {
      background: #28a745;
    }
    .controls button:hover {
      background: #1e7e34;
    }
    .stat, .stats-bar span {
      font-weight: bold;
    }
  </style>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Qu·∫£n l√Ω t√†i kho·∫£n & Clipboard (Realtime)</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
  <h1>Qu·∫£n l√Ω T√†i kho·∫£n</h1>

  <!-- T√°c v·ª• 1: D√°n clipboard -->
  <h2>T√°c v·ª• 1: D√°n n·ªôi dung t·ª´ clipboard</h2>
  <div class="stat">S·ªë d√≤ng ƒë√£ d√°n: <span id="clipboardCount">0</span></div>
  <button onclick="pasteNote()">üìã D√°n</button>
  <button onclick="exportNotes()">üìÑ Xu·∫•t .txt</button>
  <ul id="noteList"></ul>

  <!-- T√°c v·ª• 2: Qu·∫£n l√Ω t√†i kho·∫£n -->
  <h2>T√°c v·ª• 2: Qu·∫£n l√Ω t√†i kho·∫£n</h2>
  <div class="stats-bar">
    <span>Ch∆∞a d√πng: <span id="accountTotal">0</span></span>
    <span>ƒê√£ d√πng: <span id="accountCopied">0</span></span>
  </div>
  <div class="controls">
    <button onclick="filterAccounts(false)">Hi·ªán t√†i kho·∫£n ch∆∞a d√πng</button>
    <button onclick="filterAccounts(true)">Hi·ªán t√†i kho·∫£n ƒë√£ d√πng</button>
  </div>
  <input type="file" id="txtUpload" accept=".txt">
  <button onclick="deleteAllAccounts()" style="background:red; color:white">üóëÔ∏è Xo√° to√†n b·ªô d·ªØ li·ªáu</button>
  <button onclick="exportAccounts()">üìÑ Xu·∫•t .txt</button>

  <div class="stat">D·ªØ li·ªáu ƒëang hi·ªÉn th·ªã:</div>
  <div class="account-box">
    <div class="field"><span>T√™n ƒëƒÉng nh·∫≠p</span><span id="lastUsername">-</span><button onclick="copyLast('lastUsername')">Copy</button></div>
    <div class="field"><span>M·∫≠t kh·∫©u</span><span id="lastPassword">-</span><button onclick="copyLast('lastPassword')">Copy</button></div>
    <div class="field"><span>Email</span><span id="lastEmail">-</span><button onclick="copyLast('lastEmail')">Copy</button></div>
    <div class="field"><span>M·∫≠t kh·∫©u Email</span><span id="lastEmailPass">-</span><button onclick="copyLast('lastEmailPass')">Copy</button></div>
  </div>

  <!-- ID Apple qu·∫£n l√Ω -->
  <div style="margin-top: 20px;">
    <label>ID Apple: <input type="text" id="inputIdApple" placeholder="Nh·∫≠p ID Apple"></label>
    <label style="margin-left: 10px;">M·∫≠t kh·∫©u ID Apple: <input type="text" id="inputIdApplePass" placeholder="Nh·∫≠p m·∫≠t kh·∫©u"></label>
    <button onclick="updateIdAppleForAll()">L∆∞u ID Apple</button>
    <button onclick="clearIdApple()" style="background:red; color:white;">Xo√° ID Apple</button>

    <div class="field" style="margin-top: 10px;">
      <span>ID Apple:</span>
      <span id="displayIdApple">-</span>
      <button onclick="copyText('displayIdApple')">Copy</button>
    </div>
    <div class="field">
      <span>M·∫≠t kh·∫©u ID Apple:</span>
      <span id="displayIdApplePass">-</span>
      <button onclick="copyText('displayIdApplePass')">Copy</button>
    </div>
  </div>

  <div id="accountList"></div>

  <!-- Th·ªëng k√™ -->
  <div style="margin-top:20px">
    <strong>üìä Th·ªëng k√™:</strong>
    <span id="usedCount">ƒê√£ d√πng: 0</span> | <span id="unusedCount">Ch∆∞a d√πng: 0</span>
  </div>
<script>
  function deleteAllAccounts() {
    if (confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën xo√° to√†n b·ªô d·ªØ li·ªáu t√†i kho·∫£n?")) {
      db.ref("accounts").remove().then(() => {
        accounts = {};
        document.getElementById("accountList").innerHTML = "";
        document.getElementById("lastUsername").textContent = "-";
        document.getElementById("lastPassword").textContent = "-";
        document.getElementById("lastEmail").textContent = "-";
        document.getElementById("lastEmailPass").textContent = "-";
        document.getElementById("usedCount").textContent = "ƒê√£ d√πng: 0";
        document.getElementById("unusedCount").textContent = "Ch∆∞a d√πng: 0";
        document.getElementById("accountTotal").textContent = "0";
        document.getElementById("accountCopied").textContent = "0";
        updateStats();
        alert("üóëÔ∏è ƒê√£ xo√° to√†n b·ªô d·ªØ li·ªáu t√†i kho·∫£n");
      }).catch((err) => {
        alert("‚ùå L·ªói khi xo√° d·ªØ li·ªáu: " + err.message);
      });
    }
  }
</script>
</body>
</html>
